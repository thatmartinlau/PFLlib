==================================================
goal = test
device = cuda
device_id = 0
dataset = MNIST
num_classes = 10
model = CNN
batch_size = 64
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 50
top_cnt = 100
local_epochs = 5
algorithm = FedDyn
join_ratio = 0.8
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 32000
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 0.1
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
prune_interval = 5
prune_amount = 0.5
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 0.8 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3125
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.4299
Std Test Accurancy: 0.0526
Std Test AUC: 0.1484
-------------------------------------------------- 8.184967041015625

-------------Round number: 1-------------

Evaluate global model
Averaged Train Loss: 2.6561
Averaged Test Accurancy: 0.2805
Averaged Test AUC: 0.5956
Std Test Accurancy: 0.3576
Std Test AUC: 0.3250
-------------------------------------------------- 6.997792720794678

-------------Round number: 2-------------

Evaluate global model
Averaged Train Loss: 1.8483
Averaged Test Accurancy: 0.4966
Averaged Test AUC: 0.8100
Std Test Accurancy: 0.3613
Std Test AUC: 0.2070
-------------------------------------------------- 7.0464043617248535

-------------Round number: 3-------------

Evaluate global model
Averaged Train Loss: 1.4189
Averaged Test Accurancy: 0.6053
Averaged Test AUC: 0.9097
Std Test Accurancy: 0.2195
Std Test AUC: 0.0737
-------------------------------------------------- 7.67854905128479

-------------Round number: 4-------------

Evaluate global model
Averaged Train Loss: 1.2162
Averaged Test Accurancy: 0.7020
Averaged Test AUC: 0.9287
Std Test Accurancy: 0.1865
Std Test AUC: 0.0579
-------------------------------------------------- 7.067211866378784

-------------Round number: 5-------------

Evaluate global model
Averaged Train Loss: 1.1427
Averaged Test Accurancy: 0.7275
Averaged Test AUC: 0.9428
Std Test Accurancy: 0.2270
Std Test AUC: 0.0479
-------------------------------------------------- 8.109690189361572

-------------Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.9030
Averaged Test Accurancy: 0.7728
Averaged Test AUC: 0.9522
Std Test Accurancy: 0.0782
Std Test AUC: 0.0220
-------------------------------------------------- 7.388721704483032

-------------Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.8192
Averaged Test Accurancy: 0.7994
Averaged Test AUC: 0.9574
Std Test Accurancy: 0.0892
Std Test AUC: 0.0182
-------------------------------------------------- 7.05393648147583

-------------Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.6590
Averaged Test Accurancy: 0.8270
Averaged Test AUC: 0.9627
Std Test Accurancy: 0.0867
Std Test AUC: 0.0129
-------------------------------------------------- 8.047626733779907

-------------Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.6862
Averaged Test Accurancy: 0.8132
Averaged Test AUC: 0.9619
Std Test Accurancy: 0.1729
Std Test AUC: 0.0281
-------------------------------------------------- 7.308155059814453

-------------Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.9206
Averaged Test Accurancy: 0.7685
Averaged Test AUC: 0.9507
Std Test Accurancy: 0.2265
Std Test AUC: 0.0422
-------------------------------------------------- 7.838599681854248

-------------Round number: 11-------------

Evaluate global model
Averaged Train Loss: 0.9166
Averaged Test Accurancy: 0.7616
Averaged Test AUC: 0.9460
Std Test Accurancy: 0.3018
Std Test AUC: 0.0687
-------------------------------------------------- 7.241112232208252

-------------Round number: 12-------------

Evaluate global model
Averaged Train Loss: 1.7393
Averaged Test Accurancy: 0.6979
Averaged Test AUC: 0.8930
Std Test Accurancy: 0.2554
Std Test AUC: 0.1442
-------------------------------------------------- 7.620652437210083

-------------Round number: 13-------------

Evaluate global model
Averaged Train Loss: 1.1085
Averaged Test Accurancy: 0.7128
Averaged Test AUC: 0.9205
Std Test Accurancy: 0.3209
Std Test AUC: 0.0831
-------------------------------------------------- 7.9348835945129395

-------------Round number: 14-------------

Evaluate global model
Averaged Train Loss: 0.7434
Averaged Test Accurancy: 0.7933
Averaged Test AUC: 0.9554
Std Test Accurancy: 0.2122
Std Test AUC: 0.0475
-------------------------------------------------- 8.046709060668945

-------------Round number: 15-------------

Evaluate global model
Averaged Train Loss: 0.4323
Averaged Test Accurancy: 0.8814
Averaged Test AUC: 0.9770
Std Test Accurancy: 0.0992
Std Test AUC: 0.0133
-------------------------------------------------- 6.365017890930176

-------------Round number: 16-------------

Evaluate global model
Averaged Train Loss: 0.4821
Averaged Test Accurancy: 0.8752
Averaged Test AUC: 0.9733
Std Test Accurancy: 0.0803
Std Test AUC: 0.0131
-------------------------------------------------- 7.762484788894653

-------------Round number: 17-------------

Evaluate global model
Averaged Train Loss: 0.3148
Averaged Test Accurancy: 0.9280
Averaged Test AUC: 0.9847
Std Test Accurancy: 0.0449
Std Test AUC: 0.0077
-------------------------------------------------- 7.583744525909424

-------------Round number: 18-------------

Evaluate global model
Averaged Train Loss: 0.2887
Averaged Test Accurancy: 0.9345
Averaged Test AUC: 0.9871
Std Test Accurancy: 0.0350
Std Test AUC: 0.0057
-------------------------------------------------- 7.245191335678101

-------------Round number: 19-------------

Evaluate global model
Averaged Train Loss: 0.2724
Averaged Test Accurancy: 0.9381
Averaged Test AUC: 0.9879
Std Test Accurancy: 0.0320
Std Test AUC: 0.0061
-------------------------------------------------- 7.353718519210815

-------------Round number: 20-------------

Evaluate global model
Averaged Train Loss: 0.2647
Averaged Test Accurancy: 0.9395
Averaged Test AUC: 0.9880
Std Test Accurancy: 0.0301
Std Test AUC: 0.0046
-------------------------------------------------- 7.942673921585083

-------------Round number: 21-------------

Evaluate global model
Averaged Train Loss: 0.2763
Averaged Test Accurancy: 0.9366
Averaged Test AUC: 0.9852
Std Test Accurancy: 0.0304
Std Test AUC: 0.0071
-------------------------------------------------- 7.583450078964233

-------------Round number: 22-------------

Evaluate global model
Averaged Train Loss: 0.2817
Averaged Test Accurancy: 0.9246
Averaged Test AUC: 0.9859
Std Test Accurancy: 0.0556
Std Test AUC: 0.0085
-------------------------------------------------- 7.652900695800781

-------------Round number: 23-------------

Evaluate global model
Averaged Train Loss: 0.2352
Averaged Test Accurancy: 0.9417
Averaged Test AUC: 0.9891
Std Test Accurancy: 0.0311
Std Test AUC: 0.0058
-------------------------------------------------- 7.507438898086548

-------------Round number: 24-------------

Evaluate global model
Averaged Train Loss: 0.2307
Averaged Test Accurancy: 0.9413
Averaged Test AUC: 0.9887
Std Test Accurancy: 0.0385
Std Test AUC: 0.0068
-------------------------------------------------- 6.952178955078125

-------------Round number: 25-------------

Evaluate global model
Averaged Train Loss: 0.2226
Averaged Test Accurancy: 0.9487
Averaged Test AUC: 0.9888
Std Test Accurancy: 0.0288
Std Test AUC: 0.0067
-------------------------------------------------- 7.351764440536499

-------------Round number: 26-------------

Evaluate global model
Averaged Train Loss: 0.2316
Averaged Test Accurancy: 0.9451
Averaged Test AUC: 0.9879
Std Test Accurancy: 0.0347
Std Test AUC: 0.0075
-------------------------------------------------- 6.508767366409302

-------------Round number: 27-------------

Evaluate global model
Averaged Train Loss: 0.2107
Averaged Test Accurancy: 0.9512
Averaged Test AUC: 0.9903
Std Test Accurancy: 0.0290
Std Test AUC: 0.0047
-------------------------------------------------- 6.318387508392334

-------------Round number: 28-------------

Evaluate global model
Averaged Train Loss: 0.1975
Averaged Test Accurancy: 0.9529
Averaged Test AUC: 0.9908
Std Test Accurancy: 0.0284
Std Test AUC: 0.0059
-------------------------------------------------- 6.372692584991455

-------------Round number: 29-------------

Evaluate global model
Averaged Train Loss: 0.2510
Averaged Test Accurancy: 0.9351
Averaged Test AUC: 0.9862
Std Test Accurancy: 0.0803
Std Test AUC: 0.0175
-------------------------------------------------- 7.220022201538086

-------------Round number: 30-------------

Evaluate global model
Averaged Train Loss: 0.3231
Averaged Test Accurancy: 0.9004
Averaged Test AUC: 0.9827
Std Test Accurancy: 0.0925
Std Test AUC: 0.0155
-------------------------------------------------- 7.088495254516602

-------------Round number: 31-------------

Evaluate global model
Averaged Train Loss: 0.3071
Averaged Test Accurancy: 0.9010
Averaged Test AUC: 0.9849
Std Test Accurancy: 0.1264
Std Test AUC: 0.0165
-------------------------------------------------- 7.177790403366089

-------------Round number: 32-------------

Evaluate global model
Averaged Train Loss: 0.5646
Averaged Test Accurancy: 0.8518
Averaged Test AUC: 0.9731
Std Test Accurancy: 0.2117
Std Test AUC: 0.0400
-------------------------------------------------- 7.831128835678101

-------------Round number: 33-------------

Evaluate global model
Averaged Train Loss: 1.0751
Averaged Test Accurancy: 0.8002
Averaged Test AUC: 0.9243
Std Test Accurancy: 0.3067
Std Test AUC: 0.1441
-------------------------------------------------- 6.6874964237213135

-------------Round number: 34-------------

Evaluate global model
Averaged Train Loss: 0.4482
Averaged Test Accurancy: 0.8681
Averaged Test AUC: 0.9717
Std Test Accurancy: 0.1632
Std Test AUC: 0.0405
-------------------------------------------------- 7.838618278503418

-------------Round number: 35-------------

Evaluate global model
Averaged Train Loss: 0.2206
Averaged Test Accurancy: 0.9407
Averaged Test AUC: 0.9884
Std Test Accurancy: 0.0360
Std Test AUC: 0.0056
-------------------------------------------------- 7.995775461196899

-------------Round number: 36-------------

Evaluate global model
Averaged Train Loss: 0.2185
Averaged Test Accurancy: 0.9425
Averaged Test AUC: 0.9881
Std Test Accurancy: 0.0569
Std Test AUC: 0.0106
-------------------------------------------------- 7.795756578445435

-------------Round number: 37-------------

Evaluate global model
Averaged Train Loss: 0.1807
Averaged Test Accurancy: 0.9576
Averaged Test AUC: 0.9906
Std Test Accurancy: 0.0136
Std Test AUC: 0.0034
-------------------------------------------------- 7.268421173095703

-------------Round number: 38-------------

Evaluate global model
Averaged Train Loss: 0.1876
Averaged Test Accurancy: 0.9540
Averaged Test AUC: 0.9908
Std Test Accurancy: 0.0269
Std Test AUC: 0.0056
-------------------------------------------------- 7.416228294372559

-------------Round number: 39-------------

Evaluate global model
Averaged Train Loss: 0.1707
Averaged Test Accurancy: 0.9594
Averaged Test AUC: 0.9915
Std Test Accurancy: 0.0296
Std Test AUC: 0.0065
-------------------------------------------------- 7.220264196395874

-------------Round number: 40-------------

Evaluate global model
Averaged Train Loss: 0.1615
Averaged Test Accurancy: 0.9626
Averaged Test AUC: 0.9920
Std Test Accurancy: 0.0185
Std Test AUC: 0.0033
-------------------------------------------------- 6.141455888748169

-------------Round number: 41-------------

Evaluate global model
Averaged Train Loss: 0.1525
Averaged Test Accurancy: 0.9651
Averaged Test AUC: 0.9925
Std Test Accurancy: 0.0168
Std Test AUC: 0.0042
-------------------------------------------------- 7.043119192123413

-------------Round number: 42-------------

Evaluate global model
Averaged Train Loss: 0.1847
Averaged Test Accurancy: 0.9449
Averaged Test AUC: 0.9905
Std Test Accurancy: 0.0378
Std Test AUC: 0.0064
-------------------------------------------------- 7.780858278274536

-------------Round number: 43-------------

Evaluate global model
Averaged Train Loss: 0.1428
Averaged Test Accurancy: 0.9617
Averaged Test AUC: 0.9921
Std Test Accurancy: 0.0220
Std Test AUC: 0.0034
-------------------------------------------------- 7.250514984130859

-------------Round number: 44-------------

Evaluate global model
Averaged Train Loss: 0.1619
Averaged Test Accurancy: 0.9516
Averaged Test AUC: 0.9897
Std Test Accurancy: 0.0325
Std Test AUC: 0.0058
-------------------------------------------------- 7.114365816116333

-------------Round number: 45-------------

Evaluate global model
Averaged Train Loss: 0.1302
Averaged Test Accurancy: 0.9633
Averaged Test AUC: 0.9916
Std Test Accurancy: 0.0202
Std Test AUC: 0.0044
-------------------------------------------------- 7.922460079193115

-------------Round number: 46-------------

Evaluate global model
Averaged Train Loss: 0.1275
Averaged Test Accurancy: 0.9629
Averaged Test AUC: 0.9919
Std Test Accurancy: 0.0236
Std Test AUC: 0.0042
-------------------------------------------------- 7.812556028366089

-------------Round number: 47-------------

Evaluate global model
Averaged Train Loss: 0.1171
Averaged Test Accurancy: 0.9669
Averaged Test AUC: 0.9924
Std Test Accurancy: 0.0120
Std Test AUC: 0.0037
-------------------------------------------------- 7.149102687835693

-------------Round number: 48-------------

Evaluate global model
Averaged Train Loss: 0.1512
Averaged Test Accurancy: 0.9509
Averaged Test AUC: 0.9895
Std Test Accurancy: 0.0401
Std Test AUC: 0.0093
-------------------------------------------------- 7.117669105529785

-------------Round number: 49-------------

Evaluate global model
Averaged Train Loss: 0.1252
Averaged Test Accurancy: 0.9622
Averaged Test AUC: 0.9912
Std Test Accurancy: 0.0234
Std Test AUC: 0.0066
-------------------------------------------------- 7.108875274658203

-------------Round number: 50-------------

Evaluate global model
Averaged Train Loss: 0.1148
Averaged Test Accurancy: 0.9666
Averaged Test AUC: 0.9912
Std Test Accurancy: 0.0173
Std Test AUC: 0.0052
-------------------------------------------------- 7.112787485122681

Best accuracy.
0.9668703946992632

Best local accuracy.

Averaged time per iteration.
7.339484372138977
File path: ../results/MNIST_FedDyn_test_0.h5

Average time cost: 375.93s.
Length:  51
std for best accurancy: 0.0
mean for best accurancy: 0.9668703946992632
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 59948678 	Used Memory: 184.36M
The allocated memory on cuda:0: 211.37M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------

Total time cost: 376.0s.
