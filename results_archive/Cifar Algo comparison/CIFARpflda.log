==================================================
goal = test
device = cuda
device_id = 0
dataset = Cifar10
num_classes = 10
model = CNN
batch_size = 64
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 50
top_cnt = 100
local_epochs = 5
algorithm = PFL-DA
join_ratio = 0.8
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 32000
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
pruning_ratio = 0.5
pruning_method = magnitude
pruning_frequency = 1
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 0.8 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate personalized models
Averaged Train Loss: 2.3040
Averaged Test Accurancy: 0.0953
Averaged Test AUC: 0.4940
Std Test Accurancy: 0.1338
Std Test AUC: 0.1674
------------------------- time cost ------------------------- 14.231824159622192

-------------Round number: 1-------------

Evaluate personalized models
Averaged Train Loss: 1.1039
Averaged Test Accurancy: 0.5857
Averaged Test AUC: 0.9074
Std Test Accurancy: 0.2502
Std Test AUC: 0.2242
------------------------- time cost ------------------------- 12.46755838394165

-------------Round number: 2-------------

Evaluate personalized models
Averaged Train Loss: 0.6179
Averaged Test Accurancy: 0.7125
Averaged Test AUC: 0.9452
Std Test Accurancy: 0.1732
Std Test AUC: 0.1447
------------------------- time cost ------------------------- 12.665281057357788

-------------Round number: 3-------------

Evaluate personalized models
Averaged Train Loss: 0.4545
Averaged Test Accurancy: 0.7853
Averaged Test AUC: 0.9622
Std Test Accurancy: 0.0593
Std Test AUC: 0.0066
------------------------- time cost ------------------------- 12.29014801979065

-------------Round number: 4-------------

Evaluate personalized models
Averaged Train Loss: 0.4175
Averaged Test Accurancy: 0.8025
Averaged Test AUC: 0.9653
Std Test Accurancy: 0.0544
Std Test AUC: 0.0062
------------------------- time cost ------------------------- 11.825626134872437

-------------Round number: 5-------------

Evaluate personalized models
Averaged Train Loss: 0.4062
Averaged Test Accurancy: 0.8066
Averaged Test AUC: 0.9666
Std Test Accurancy: 0.0519
Std Test AUC: 0.0069
------------------------- time cost ------------------------- 11.091556310653687

-------------Round number: 6-------------

Evaluate personalized models
Averaged Train Loss: 0.3711
Averaged Test Accurancy: 0.8235
Averaged Test AUC: 0.9686
Std Test Accurancy: 0.0537
Std Test AUC: 0.0071
------------------------- time cost ------------------------- 11.575602054595947

-------------Round number: 7-------------

Evaluate personalized models
Averaged Train Loss: 0.3645
Averaged Test Accurancy: 0.8277
Averaged Test AUC: 0.9700
Std Test Accurancy: 0.0528
Std Test AUC: 0.0073
------------------------- time cost ------------------------- 12.73433804512024

-------------Round number: 8-------------

Evaluate personalized models
Averaged Train Loss: 0.3496
Averaged Test Accurancy: 0.8286
Averaged Test AUC: 0.9716
Std Test Accurancy: 0.0538
Std Test AUC: 0.0067
------------------------- time cost ------------------------- 13.51798939704895

-------------Round number: 9-------------

Evaluate personalized models
Averaged Train Loss: 0.3313
Averaged Test Accurancy: 0.8406
Averaged Test AUC: 0.9729
Std Test Accurancy: 0.0520
Std Test AUC: 0.0076
------------------------- time cost ------------------------- 13.471306800842285

-------------Round number: 10-------------

Evaluate personalized models
Averaged Train Loss: 0.3056
Averaged Test Accurancy: 0.8510
Averaged Test AUC: 0.9740
Std Test Accurancy: 0.0549
Std Test AUC: 0.0078
------------------------- time cost ------------------------- 11.434984922409058

-------------Round number: 11-------------

Evaluate personalized models
Averaged Train Loss: 0.2947
Averaged Test Accurancy: 0.8544
Averaged Test AUC: 0.9755
Std Test Accurancy: 0.0525
Std Test AUC: 0.0073
------------------------- time cost ------------------------- 12.263679027557373

-------------Round number: 12-------------

Evaluate personalized models
Averaged Train Loss: 0.2824
Averaged Test Accurancy: 0.8572
Averaged Test AUC: 0.9766
Std Test Accurancy: 0.0528
Std Test AUC: 0.0073
------------------------- time cost ------------------------- 12.906686544418335

-------------Round number: 13-------------

Evaluate personalized models
Averaged Train Loss: 0.2666
Averaged Test Accurancy: 0.8613
Averaged Test AUC: 0.9777
Std Test Accurancy: 0.0492
Std Test AUC: 0.0077
------------------------- time cost ------------------------- 13.647532939910889

-------------Round number: 14-------------

Evaluate personalized models
Averaged Train Loss: 0.2713
Averaged Test Accurancy: 0.8578
Averaged Test AUC: 0.9782
Std Test Accurancy: 0.0527
Std Test AUC: 0.0078
------------------------- time cost ------------------------- 12.814729690551758

-------------Round number: 15-------------

Evaluate personalized models
Averaged Train Loss: 0.2599
Averaged Test Accurancy: 0.8612
Averaged Test AUC: 0.9790
Std Test Accurancy: 0.0562
Std Test AUC: 0.0073
------------------------- time cost ------------------------- 12.586178064346313

-------------Round number: 16-------------

Evaluate personalized models
Averaged Train Loss: 0.2390
Averaged Test Accurancy: 0.8687
Averaged Test AUC: 0.9794
Std Test Accurancy: 0.0517
Std Test AUC: 0.0077
------------------------- time cost ------------------------- 12.106228351593018

-------------Round number: 17-------------

Evaluate personalized models
Averaged Train Loss: 0.2331
Averaged Test Accurancy: 0.8675
Averaged Test AUC: 0.9803
Std Test Accurancy: 0.0579
Std Test AUC: 0.0076
------------------------- time cost ------------------------- 13.910800218582153

-------------Round number: 18-------------

Evaluate personalized models
Averaged Train Loss: 0.2340
Averaged Test Accurancy: 0.8614
Averaged Test AUC: 0.9810
Std Test Accurancy: 0.0601
Std Test AUC: 0.0085
------------------------- time cost ------------------------- 12.182629823684692

-------------Round number: 19-------------

Evaluate personalized models
Averaged Train Loss: 0.2258
Averaged Test Accurancy: 0.8655
Averaged Test AUC: 0.9820
Std Test Accurancy: 0.0572
Std Test AUC: 0.0071
------------------------- time cost ------------------------- 12.810081243515015

-------------Round number: 20-------------

Evaluate personalized models
Averaged Train Loss: 0.2340
Averaged Test Accurancy: 0.8634
Averaged Test AUC: 0.9819
Std Test Accurancy: 0.0655
Std Test AUC: 0.0085
------------------------- time cost ------------------------- 12.757288217544556

-------------Round number: 21-------------

Evaluate personalized models
Averaged Train Loss: 0.2234
Averaged Test Accurancy: 0.8650
Averaged Test AUC: 0.9828
Std Test Accurancy: 0.0487
Std Test AUC: 0.0075
------------------------- time cost ------------------------- 10.674741744995117

-------------Round number: 22-------------

Evaluate personalized models
Averaged Train Loss: 0.2153
Averaged Test Accurancy: 0.8686
Averaged Test AUC: 0.9836
Std Test Accurancy: 0.0474
Std Test AUC: 0.0071
------------------------- time cost ------------------------- 12.523057222366333

-------------Round number: 23-------------

Evaluate personalized models
Averaged Train Loss: 0.2182
Averaged Test Accurancy: 0.8633
Averaged Test AUC: 0.9832
Std Test Accurancy: 0.0494
Std Test AUC: 0.0073
------------------------- time cost ------------------------- 13.701238632202148

-------------Round number: 24-------------

Evaluate personalized models
Averaged Train Loss: 0.1698
Averaged Test Accurancy: 0.8765
Averaged Test AUC: 0.9847
Std Test Accurancy: 0.0530
Std Test AUC: 0.0074
------------------------- time cost ------------------------- 11.298136472702026

-------------Round number: 25-------------

Evaluate personalized models
Averaged Train Loss: 0.1752
Averaged Test Accurancy: 0.8737
Averaged Test AUC: 0.9843
Std Test Accurancy: 0.0594
Std Test AUC: 0.0079
------------------------- time cost ------------------------- 12.75677490234375

-------------Round number: 26-------------

Evaluate personalized models
Averaged Train Loss: 0.1648
Averaged Test Accurancy: 0.8744
Averaged Test AUC: 0.9853
Std Test Accurancy: 0.0560
Std Test AUC: 0.0069
------------------------- time cost ------------------------- 12.68344759941101

-------------Round number: 27-------------

Evaluate personalized models
Averaged Train Loss: 0.1563
Averaged Test Accurancy: 0.8761
Averaged Test AUC: 0.9858
Std Test Accurancy: 0.0571
Std Test AUC: 0.0068
------------------------- time cost ------------------------- 12.836945056915283

-------------Round number: 28-------------

Evaluate personalized models
Averaged Train Loss: 0.1494
Averaged Test Accurancy: 0.8789
Averaged Test AUC: 0.9866
Std Test Accurancy: 0.0519
Std Test AUC: 0.0066
------------------------- time cost ------------------------- 13.84009075164795

-------------Round number: 29-------------

Evaluate personalized models
Averaged Train Loss: 0.1505
Averaged Test Accurancy: 0.8754
Averaged Test AUC: 0.9860
Std Test Accurancy: 0.0530
Std Test AUC: 0.0067
------------------------- time cost ------------------------- 13.843064546585083

-------------Round number: 30-------------

Evaluate personalized models
Averaged Train Loss: 0.1273
Averaged Test Accurancy: 0.8812
Averaged Test AUC: 0.9865
Std Test Accurancy: 0.0599
Std Test AUC: 0.0082
------------------------- time cost ------------------------- 12.948699712753296

-------------Round number: 31-------------

Evaluate personalized models
Averaged Train Loss: 0.1229
Averaged Test Accurancy: 0.8811
Averaged Test AUC: 0.9871
Std Test Accurancy: 0.0534
Std Test AUC: 0.0071
------------------------- time cost ------------------------- 12.631133794784546

-------------Round number: 32-------------

Evaluate personalized models
Averaged Train Loss: 0.1290
Averaged Test Accurancy: 0.8748
Averaged Test AUC: 0.9868
Std Test Accurancy: 0.0654
Std Test AUC: 0.0081
------------------------- time cost ------------------------- 11.91550350189209

-------------Round number: 33-------------

Evaluate personalized models
Averaged Train Loss: 0.1153
Averaged Test Accurancy: 0.8827
Averaged Test AUC: 0.9877
Std Test Accurancy: 0.0569
Std Test AUC: 0.0076
------------------------- time cost ------------------------- 13.56926441192627

-------------Round number: 34-------------

Evaluate personalized models
Averaged Train Loss: 0.1108
Averaged Test Accurancy: 0.8799
Averaged Test AUC: 0.9882
Std Test Accurancy: 0.0532
Std Test AUC: 0.0073
------------------------- time cost ------------------------- 11.438885688781738

-------------Round number: 35-------------

Evaluate personalized models
Averaged Train Loss: 0.1030
Averaged Test Accurancy: 0.8789
Averaged Test AUC: 0.9876
Std Test Accurancy: 0.0577
Std Test AUC: 0.0077
------------------------- time cost ------------------------- 12.317946910858154

-------------Round number: 36-------------

Evaluate personalized models
Averaged Train Loss: 0.0893
Averaged Test Accurancy: 0.8863
Averaged Test AUC: 0.9882
Std Test Accurancy: 0.0668
Std Test AUC: 0.0086
------------------------- time cost ------------------------- 12.798635482788086

-------------Round number: 37-------------

Evaluate personalized models
Averaged Train Loss: 0.0831
Averaged Test Accurancy: 0.8863
Averaged Test AUC: 0.9888
Std Test Accurancy: 0.0530
Std Test AUC: 0.0066
------------------------- time cost ------------------------- 11.79330325126648

-------------Round number: 38-------------

Evaluate personalized models
Averaged Train Loss: 0.0824
Averaged Test Accurancy: 0.8813
Averaged Test AUC: 0.9887
Std Test Accurancy: 0.0592
Std Test AUC: 0.0075
------------------------- time cost ------------------------- 12.783698081970215

-------------Round number: 39-------------

Evaluate personalized models
Averaged Train Loss: 0.0741
Averaged Test Accurancy: 0.8847
Averaged Test AUC: 0.9890
Std Test Accurancy: 0.0584
Std Test AUC: 0.0072
------------------------- time cost ------------------------- 13.93551254272461

-------------Round number: 40-------------

Evaluate personalized models
Averaged Train Loss: 0.0670
Averaged Test Accurancy: 0.8820
Averaged Test AUC: 0.9891
Std Test Accurancy: 0.0586
Std Test AUC: 0.0075
------------------------- time cost ------------------------- 11.01891279220581

-------------Round number: 41-------------

Evaluate personalized models
Averaged Train Loss: 0.0616
Averaged Test Accurancy: 0.8840
Averaged Test AUC: 0.9893
Std Test Accurancy: 0.0528
Std Test AUC: 0.0069
------------------------- time cost ------------------------- 11.904643297195435

-------------Round number: 42-------------

Evaluate personalized models
Averaged Train Loss: 0.0572
Averaged Test Accurancy: 0.8813
Averaged Test AUC: 0.9895
Std Test Accurancy: 0.0693
Std Test AUC: 0.0083
------------------------- time cost ------------------------- 13.785226583480835

-------------Round number: 43-------------

Evaluate personalized models
Averaged Train Loss: 0.0572
Averaged Test Accurancy: 0.8852
Averaged Test AUC: 0.9896
Std Test Accurancy: 0.0558
Std Test AUC: 0.0066
------------------------- time cost ------------------------- 13.180499076843262

-------------Round number: 44-------------

Evaluate personalized models
Averaged Train Loss: 0.0523
Averaged Test Accurancy: 0.8845
Averaged Test AUC: 0.9895
Std Test Accurancy: 0.0539
Std Test AUC: 0.0074
------------------------- time cost ------------------------- 13.138885021209717

-------------Round number: 45-------------

Evaluate personalized models
Averaged Train Loss: 0.0559
Averaged Test Accurancy: 0.8845
Averaged Test AUC: 0.9899
Std Test Accurancy: 0.0526
Std Test AUC: 0.0065
------------------------- time cost ------------------------- 11.608277559280396

-------------Round number: 46-------------

Evaluate personalized models
Averaged Train Loss: 0.0474
Averaged Test Accurancy: 0.8865
Averaged Test AUC: 0.9898
Std Test Accurancy: 0.0553
Std Test AUC: 0.0077
------------------------- time cost ------------------------- 13.695059061050415

-------------Round number: 47-------------

Evaluate personalized models
Averaged Train Loss: 0.0414
Averaged Test Accurancy: 0.8863
Averaged Test AUC: 0.9896
Std Test Accurancy: 0.0551
Std Test AUC: 0.0074
------------------------- time cost ------------------------- 12.578457593917847

-------------Round number: 48-------------

Evaluate personalized models
Averaged Train Loss: 0.0447
Averaged Test Accurancy: 0.8854
Averaged Test AUC: 0.9898
Std Test Accurancy: 0.0577
Std Test AUC: 0.0068
------------------------- time cost ------------------------- 12.803855657577515

-------------Round number: 49-------------

Evaluate personalized models
Averaged Train Loss: 0.0365
Averaged Test Accurancy: 0.8877
Averaged Test AUC: 0.9901
Std Test Accurancy: 0.0563
Std Test AUC: 0.0069
------------------------- time cost ------------------------- 12.930334568023682

-------------Round number: 50-------------

Evaluate personalized models
Averaged Train Loss: 0.0344
Averaged Test Accurancy: 0.8864
Averaged Test AUC: 0.9899
Std Test Accurancy: 0.0531
Std Test AUC: 0.0071
------------------------- time cost ------------------------- 13.82558560371399

Best accuracy.
0.8877415056628915

Average time cost per round.
12.636400847434997
File path: ../results/Cifar10_PFL-DA_test_0.h5

Average time cost: 648.19s.
Length:  51
std for best accurancy: 0.0
mean for best accurancy: 0.8877415056628915
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 53698548 	Used Memory: 137.87M
The allocated memory on cuda:0: 154.19M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------

Total time cost: 648.26s.
