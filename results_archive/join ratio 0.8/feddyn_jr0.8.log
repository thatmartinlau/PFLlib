==================================================
goal = test
device = cuda
device_id = 0
dataset = MNIST
num_classes = 10
model = CNN
batch_size = 64
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 50
top_cnt = 100
local_epochs = 5
algorithm = FedDyn
join_ratio = 0.8
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 32000
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 0.1
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
prune_interval = 5
prune_amount = 0.5
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 0.8 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3125
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.4299
Std Test Accurancy: 0.0526
Std Test AUC: 0.1484
-------------------------------------------------- 7.376021862030029

-------------Round number: 1-------------

Evaluate global model
Averaged Train Loss: 2.3408
Averaged Test Accurancy: 0.1911
Averaged Test AUC: 0.6919
Std Test Accurancy: 0.3873
Std Test AUC: 0.1716
-------------------------------------------------- 7.0259130001068115

-------------Round number: 2-------------

Evaluate global model
Averaged Train Loss: 1.4309
Averaged Test Accurancy: 0.6340
Averaged Test AUC: 0.9208
Std Test Accurancy: 0.1714
Std Test AUC: 0.0413
-------------------------------------------------- 7.47030782699585

-------------Round number: 3-------------

Evaluate global model
Averaged Train Loss: 1.2059
Averaged Test Accurancy: 0.6340
Averaged Test AUC: 0.9295
Std Test Accurancy: 0.1891
Std Test AUC: 0.0413
-------------------------------------------------- 7.254498243331909

-------------Round number: 4-------------

Evaluate global model
Averaged Train Loss: 1.1940
Averaged Test Accurancy: 0.6934
Averaged Test AUC: 0.9311
Std Test Accurancy: 0.1820
Std Test AUC: 0.0484
-------------------------------------------------- 6.590816259384155

-------------Round number: 5-------------

Evaluate global model
Averaged Train Loss: 1.0396
Averaged Test Accurancy: 0.7514
Averaged Test AUC: 0.9468
Std Test Accurancy: 0.1166
Std Test AUC: 0.0264
-------------------------------------------------- 7.914629936218262

-------------Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.9518
Averaged Test Accurancy: 0.7654
Averaged Test AUC: 0.9504
Std Test Accurancy: 0.0865
Std Test AUC: 0.0240
-------------------------------------------------- 7.790077209472656

-------------Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.8443
Averaged Test Accurancy: 0.7903
Averaged Test AUC: 0.9551
Std Test Accurancy: 0.1602
Std Test AUC: 0.0334
-------------------------------------------------- 7.103568077087402

-------------Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.9153
Averaged Test Accurancy: 0.7550
Averaged Test AUC: 0.9530
Std Test Accurancy: 0.1374
Std Test AUC: 0.0193
-------------------------------------------------- 7.683901786804199

-------------Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.8338
Averaged Test Accurancy: 0.7865
Averaged Test AUC: 0.9567
Std Test Accurancy: 0.2505
Std Test AUC: 0.0475
-------------------------------------------------- 7.761429071426392

-------------Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.8996
Averaged Test Accurancy: 0.7540
Averaged Test AUC: 0.9548
Std Test Accurancy: 0.2218
Std Test AUC: 0.0371
-------------------------------------------------- 7.936657905578613

-------------Round number: 11-------------

Evaluate global model
Averaged Train Loss: 0.9469
Averaged Test Accurancy: 0.7815
Averaged Test AUC: 0.9445
Std Test Accurancy: 0.2785
Std Test AUC: 0.0775
-------------------------------------------------- 7.10162615776062

-------------Round number: 12-------------

Evaluate global model
Averaged Train Loss: 0.5869
Averaged Test Accurancy: 0.8302
Averaged Test AUC: 0.9636
Std Test Accurancy: 0.1474
Std Test AUC: 0.0316
-------------------------------------------------- 7.7435455322265625

-------------Round number: 13-------------

Evaluate global model
Averaged Train Loss: 0.3994
Averaged Test Accurancy: 0.9022
Averaged Test AUC: 0.9768
Std Test Accurancy: 0.0444
Std Test AUC: 0.0085
-------------------------------------------------- 7.2413976192474365

-------------Round number: 14-------------

Evaluate global model
Averaged Train Loss: 0.4465
Averaged Test Accurancy: 0.8778
Averaged Test AUC: 0.9741
Std Test Accurancy: 0.0821
Std Test AUC: 0.0148
-------------------------------------------------- 6.270115852355957

-------------Round number: 15-------------

Evaluate global model
Averaged Train Loss: 0.3672
Averaged Test Accurancy: 0.9112
Averaged Test AUC: 0.9802
Std Test Accurancy: 0.0444
Std Test AUC: 0.0041
-------------------------------------------------- 6.8597564697265625

-------------Round number: 16-------------

Evaluate global model
Averaged Train Loss: 0.3239
Averaged Test Accurancy: 0.9250
Averaged Test AUC: 0.9836
Std Test Accurancy: 0.0423
Std Test AUC: 0.0088
-------------------------------------------------- 7.800142765045166

-------------Round number: 17-------------

Evaluate global model
Averaged Train Loss: 0.3705
Averaged Test Accurancy: 0.9032
Averaged Test AUC: 0.9800
Std Test Accurancy: 0.1072
Std Test AUC: 0.0187
-------------------------------------------------- 7.040303468704224

-------------Round number: 18-------------

Evaluate global model
Averaged Train Loss: 0.2805
Averaged Test Accurancy: 0.9332
Averaged Test AUC: 0.9867
Std Test Accurancy: 0.0308
Std Test AUC: 0.0040
-------------------------------------------------- 6.341401100158691

-------------Round number: 19-------------

Evaluate global model
Averaged Train Loss: 0.3091
Averaged Test Accurancy: 0.9264
Averaged Test AUC: 0.9844
Std Test Accurancy: 0.0381
Std Test AUC: 0.0042
-------------------------------------------------- 7.887218952178955

-------------Round number: 20-------------

Evaluate global model
Averaged Train Loss: 0.2944
Averaged Test Accurancy: 0.9216
Averaged Test AUC: 0.9862
Std Test Accurancy: 0.0676
Std Test AUC: 0.0112
-------------------------------------------------- 7.8552210330963135

-------------Round number: 21-------------

Evaluate global model
Averaged Train Loss: 0.2288
Averaged Test Accurancy: 0.9485
Averaged Test AUC: 0.9886
Std Test Accurancy: 0.0221
Std Test AUC: 0.0044
-------------------------------------------------- 7.79809045791626

-------------Round number: 22-------------

Evaluate global model
Averaged Train Loss: 0.2193
Averaged Test Accurancy: 0.9473
Averaged Test AUC: 0.9896
Std Test Accurancy: 0.0146
Std Test AUC: 0.0025
-------------------------------------------------- 7.025691986083984

-------------Round number: 23-------------

Evaluate global model
Averaged Train Loss: 0.2332
Averaged Test Accurancy: 0.9366
Averaged Test AUC: 0.9889
Std Test Accurancy: 0.0363
Std Test AUC: 0.0058
-------------------------------------------------- 7.806551933288574

-------------Round number: 24-------------

Evaluate global model
Averaged Train Loss: 0.2278
Averaged Test Accurancy: 0.9423
Averaged Test AUC: 0.9899
Std Test Accurancy: 0.0349
Std Test AUC: 0.0049
-------------------------------------------------- 7.887248992919922

-------------Round number: 25-------------

Evaluate global model
Averaged Train Loss: 0.2203
Averaged Test Accurancy: 0.9470
Averaged Test AUC: 0.9901
Std Test Accurancy: 0.0285
Std Test AUC: 0.0053
-------------------------------------------------- 6.83952260017395

-------------Round number: 26-------------

Evaluate global model
Averaged Train Loss: 0.2428
Averaged Test Accurancy: 0.9468
Averaged Test AUC: 0.9882
Std Test Accurancy: 0.0197
Std Test AUC: 0.0049
-------------------------------------------------- 6.47630500793457

-------------Round number: 27-------------

Evaluate global model
Averaged Train Loss: 0.2368
Averaged Test Accurancy: 0.9428
Averaged Test AUC: 0.9890
Std Test Accurancy: 0.0438
Std Test AUC: 0.0092
-------------------------------------------------- 6.720971345901489

-------------Round number: 28-------------

Evaluate global model
Averaged Train Loss: 0.2156
Averaged Test Accurancy: 0.9476
Averaged Test AUC: 0.9909
Std Test Accurancy: 0.0292
Std Test AUC: 0.0061
-------------------------------------------------- 7.2321906089782715

-------------Round number: 29-------------

Evaluate global model
Averaged Train Loss: 0.2443
Averaged Test Accurancy: 0.9381
Averaged Test AUC: 0.9891
Std Test Accurancy: 0.0480
Std Test AUC: 0.0077
-------------------------------------------------- 7.7551233768463135

-------------Round number: 30-------------

Evaluate global model
Averaged Train Loss: 0.1995
Averaged Test Accurancy: 0.9513
Averaged Test AUC: 0.9914
Std Test Accurancy: 0.0236
Std Test AUC: 0.0037
-------------------------------------------------- 7.079609155654907

-------------Round number: 31-------------

Evaluate global model
Averaged Train Loss: 0.1989
Averaged Test Accurancy: 0.9487
Averaged Test AUC: 0.9910
Std Test Accurancy: 0.0292
Std Test AUC: 0.0058
-------------------------------------------------- 7.1014344692230225

-------------Round number: 32-------------

Evaluate global model
Averaged Train Loss: 0.2334
Averaged Test Accurancy: 0.9410
Averaged Test AUC: 0.9884
Std Test Accurancy: 0.0693
Std Test AUC: 0.0152
-------------------------------------------------- 7.32349157333374

-------------Round number: 33-------------

Evaluate global model
Averaged Train Loss: 0.1965
Averaged Test Accurancy: 0.9487
Averaged Test AUC: 0.9901
Std Test Accurancy: 0.0437
Std Test AUC: 0.0093
-------------------------------------------------- 7.143910646438599

-------------Round number: 34-------------

Evaluate global model
Averaged Train Loss: 0.2199
Averaged Test Accurancy: 0.9400
Averaged Test AUC: 0.9881
Std Test Accurancy: 0.0344
Std Test AUC: 0.0094
-------------------------------------------------- 6.384447336196899

-------------Round number: 35-------------

Evaluate global model
Averaged Train Loss: 0.1610
Averaged Test Accurancy: 0.9580
Averaged Test AUC: 0.9924
Std Test Accurancy: 0.0195
Std Test AUC: 0.0038
-------------------------------------------------- 7.787519931793213

-------------Round number: 36-------------

Evaluate global model
Averaged Train Loss: 0.1677
Averaged Test Accurancy: 0.9560
Averaged Test AUC: 0.9921
Std Test Accurancy: 0.0302
Std Test AUC: 0.0064
-------------------------------------------------- 7.154765605926514

-------------Round number: 37-------------

Evaluate global model
Averaged Train Loss: 0.1557
Averaged Test Accurancy: 0.9591
Averaged Test AUC: 0.9926
Std Test Accurancy: 0.0154
Std Test AUC: 0.0028
-------------------------------------------------- 7.8062005043029785

-------------Round number: 38-------------

Evaluate global model
Averaged Train Loss: 0.1677
Averaged Test Accurancy: 0.9544
Averaged Test AUC: 0.9915
Std Test Accurancy: 0.0337
Std Test AUC: 0.0064
-------------------------------------------------- 7.038635969161987

-------------Round number: 39-------------

Evaluate global model
Averaged Train Loss: 0.1535
Averaged Test Accurancy: 0.9571
Averaged Test AUC: 0.9923
Std Test Accurancy: 0.0243
Std Test AUC: 0.0041
-------------------------------------------------- 7.811932802200317

-------------Round number: 40-------------

Evaluate global model
Averaged Train Loss: 0.1561
Averaged Test Accurancy: 0.9587
Averaged Test AUC: 0.9914
Std Test Accurancy: 0.0366
Std Test AUC: 0.0085
-------------------------------------------------- 7.141479969024658

-------------Round number: 41-------------

Evaluate global model
Averaged Train Loss: 0.1480
Averaged Test Accurancy: 0.9601
Averaged Test AUC: 0.9920
Std Test Accurancy: 0.0304
Std Test AUC: 0.0067
-------------------------------------------------- 7.796244859695435

-------------Round number: 42-------------

Evaluate global model
Averaged Train Loss: 0.1498
Averaged Test Accurancy: 0.9585
Averaged Test AUC: 0.9919
Std Test Accurancy: 0.0270
Std Test AUC: 0.0052
-------------------------------------------------- 6.984940528869629

-------------Round number: 43-------------

Evaluate global model
Averaged Train Loss: 0.1401
Averaged Test Accurancy: 0.9585
Averaged Test AUC: 0.9926
Std Test Accurancy: 0.0229
Std Test AUC: 0.0051
-------------------------------------------------- 6.666980504989624

-------------Round number: 44-------------

Evaluate global model
Averaged Train Loss: 0.1453
Averaged Test Accurancy: 0.9585
Averaged Test AUC: 0.9915
Std Test Accurancy: 0.0278
Std Test AUC: 0.0062
-------------------------------------------------- 7.5934014320373535

-------------Round number: 45-------------

Evaluate global model
Averaged Train Loss: 0.1427
Averaged Test Accurancy: 0.9566
Averaged Test AUC: 0.9909
Std Test Accurancy: 0.0277
Std Test AUC: 0.0060
-------------------------------------------------- 6.959350347518921

-------------Round number: 46-------------

Evaluate global model
Averaged Train Loss: 0.1425
Averaged Test Accurancy: 0.9554
Averaged Test AUC: 0.9915
Std Test Accurancy: 0.0257
Std Test AUC: 0.0050
-------------------------------------------------- 7.644455432891846

-------------Round number: 47-------------

Evaluate global model
Averaged Train Loss: 0.1262
Averaged Test Accurancy: 0.9621
Averaged Test AUC: 0.9927
Std Test Accurancy: 0.0214
Std Test AUC: 0.0038
-------------------------------------------------- 6.354363679885864

-------------Round number: 48-------------

Evaluate global model
Averaged Train Loss: 0.1244
Averaged Test Accurancy: 0.9629
Averaged Test AUC: 0.9922
Std Test Accurancy: 0.0211
Std Test AUC: 0.0044
-------------------------------------------------- 7.061980962753296

-------------Round number: 49-------------

Evaluate global model
Averaged Train Loss: 0.1203
Averaged Test Accurancy: 0.9674
Averaged Test AUC: 0.9925
Std Test Accurancy: 0.0176
Std Test AUC: 0.0046
-------------------------------------------------- 7.482050180435181

-------------Round number: 50-------------

Evaluate global model
Averaged Train Loss: 0.1183
Averaged Test Accurancy: 0.9650
Averaged Test AUC: 0.9928
Std Test Accurancy: 0.0201
Std Test AUC: 0.0044
-------------------------------------------------- 7.695987224578857

Best accuracy.
0.9674415947906552

Best local accuracy.

Averaged time per iteration.
7.2845481538772585
File path: ../results/MNIST_FedDyn_test_0.h5

Average time cost: 372.35s.
Length:  51
std for best accurancy: 0.0
mean for best accurancy: 0.9674415947906552
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 59948678 	Used Memory: 184.36M
The allocated memory on cuda:0: 212.10M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------

Total time cost: 372.42s.
