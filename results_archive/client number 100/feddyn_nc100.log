==================================================
goal = test
device = cuda
device_id = 0
dataset = MNIST
num_classes = 10
model = CNN
batch_size = 64
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 50
top_cnt = 100
local_epochs = 5
algorithm = FedDyn
join_ratio = 0.8
random_join_ratio = False
num_clients = 100
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 32000
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 0.1
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
prune_interval = 5
prune_amount = 0.5
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 0.8 / 100
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3126
Averaged Test Accurancy: 0.0585
Averaged Test AUC: 0.4282
Std Test Accurancy: 0.0714
Std Test AUC: 0.1732
-------------------------------------------------- 7.422498941421509

-------------Round number: 1-------------

Evaluate global model
Averaged Train Loss: 2.3640
Averaged Test Accurancy: 0.1393
Averaged Test AUC: 0.5640
Std Test Accurancy: 0.2015
Std Test AUC: 0.2877
-------------------------------------------------- 7.794306755065918

-------------Round number: 2-------------

Evaluate global model
Averaged Train Loss: 2.2764
Averaged Test Accurancy: 0.2612
Averaged Test AUC: 0.6536
Std Test Accurancy: 0.3813
Std Test AUC: 0.2561
-------------------------------------------------- 7.827637195587158

-------------Round number: 3-------------

Evaluate global model
Averaged Train Loss: 2.0260
Averaged Test Accurancy: 0.5050
Averaged Test AUC: 0.8304
Std Test Accurancy: 0.4018
Std Test AUC: 0.1837
-------------------------------------------------- 7.837855815887451

-------------Round number: 4-------------

Evaluate global model
Averaged Train Loss: 1.7510
Averaged Test Accurancy: 0.6224
Averaged Test AUC: 0.9190
Std Test Accurancy: 0.2743
Std Test AUC: 0.0592
-------------------------------------------------- 7.928678512573242

-------------Round number: 5-------------

Evaluate global model
Averaged Train Loss: 1.4119
Averaged Test Accurancy: 0.6801
Averaged Test AUC: 0.9292
Std Test Accurancy: 0.2292
Std Test AUC: 0.0499
-------------------------------------------------- 7.806155204772949

-------------Round number: 6-------------

Evaluate global model
Averaged Train Loss: 1.1891
Averaged Test Accurancy: 0.7291
Averaged Test AUC: 0.9414
Std Test Accurancy: 0.1618
Std Test AUC: 0.0335
-------------------------------------------------- 7.0611302852630615

-------------Round number: 7-------------

Evaluate global model
Averaged Train Loss: 1.0938
Averaged Test Accurancy: 0.7464
Averaged Test AUC: 0.9443
Std Test Accurancy: 0.1215
Std Test AUC: 0.0257
-------------------------------------------------- 6.9328835010528564

-------------Round number: 8-------------

Evaluate global model
Averaged Train Loss: 1.0424
Averaged Test Accurancy: 0.7556
Averaged Test AUC: 0.9463
Std Test Accurancy: 0.1338
Std Test AUC: 0.0296
-------------------------------------------------- 7.165173768997192

-------------Round number: 9-------------

Evaluate global model
Averaged Train Loss: 1.0106
Averaged Test Accurancy: 0.7705
Averaged Test AUC: 0.9499
Std Test Accurancy: 0.0846
Std Test AUC: 0.0167
-------------------------------------------------- 7.758577108383179

-------------Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.9362
Averaged Test Accurancy: 0.7882
Averaged Test AUC: 0.9523
Std Test Accurancy: 0.0992
Std Test AUC: 0.0213
-------------------------------------------------- 7.5558671951293945

-------------Round number: 11-------------

Evaluate global model
Averaged Train Loss: 0.8638
Averaged Test Accurancy: 0.8046
Averaged Test AUC: 0.9548
Std Test Accurancy: 0.0687
Std Test AUC: 0.0140
-------------------------------------------------- 7.568551301956177

-------------Round number: 12-------------

Evaluate global model
Averaged Train Loss: 0.8039
Averaged Test Accurancy: 0.8118
Averaged Test AUC: 0.9558
Std Test Accurancy: 0.1124
Std Test AUC: 0.0212
-------------------------------------------------- 5.814772129058838

-------------Round number: 13-------------

Evaluate global model
Averaged Train Loss: 0.9979
Averaged Test Accurancy: 0.7564
Averaged Test AUC: 0.9525
Std Test Accurancy: 0.1853
Std Test AUC: 0.0308
-------------------------------------------------- 6.47741436958313

-------------Round number: 14-------------

Evaluate global model
Averaged Train Loss: 1.8697
Averaged Test Accurancy: 0.7241
Averaged Test AUC: 0.9069
Std Test Accurancy: 0.3402
Std Test AUC: 0.1414
-------------------------------------------------- 7.121929883956909

-------------Round number: 15-------------

Evaluate global model
Averaged Train Loss: 0.8873
Averaged Test Accurancy: 0.7799
Averaged Test AUC: 0.9515
Std Test Accurancy: 0.1653
Std Test AUC: 0.0374
-------------------------------------------------- 7.015328884124756

-------------Round number: 16-------------

Evaluate global model
Averaged Train Loss: 0.8780
Averaged Test Accurancy: 0.7722
Averaged Test AUC: 0.9513
Std Test Accurancy: 0.2382
Std Test AUC: 0.0424
-------------------------------------------------- 6.953361749649048

-------------Round number: 17-------------

Evaluate global model
Averaged Train Loss: 1.1597
Averaged Test Accurancy: 0.7222
Averaged Test AUC: 0.9465
Std Test Accurancy: 0.2750
Std Test AUC: 0.0455
-------------------------------------------------- 6.95644736289978

-------------Round number: 18-------------

Evaluate global model
Averaged Train Loss: 1.2149
Averaged Test Accurancy: 0.7717
Averaged Test AUC: 0.9368
Std Test Accurancy: 0.3016
Std Test AUC: 0.0874
-------------------------------------------------- 6.806771755218506

-------------Round number: 19-------------

Evaluate global model
Averaged Train Loss: 0.5481
Averaged Test Accurancy: 0.8595
Averaged Test AUC: 0.9653
Std Test Accurancy: 0.1093
Std Test AUC: 0.0171
-------------------------------------------------- 6.309915065765381

-------------Round number: 20-------------

Evaluate global model
Averaged Train Loss: 0.5143
Averaged Test Accurancy: 0.8714
Averaged Test AUC: 0.9653
Std Test Accurancy: 0.0615
Std Test AUC: 0.0102
-------------------------------------------------- 7.493480443954468

-------------Round number: 21-------------

Evaluate global model
Averaged Train Loss: 0.4468
Averaged Test Accurancy: 0.8932
Averaged Test AUC: 0.9676
Std Test Accurancy: 0.0604
Std Test AUC: 0.0117
-------------------------------------------------- 7.451745986938477

-------------Round number: 22-------------

Evaluate global model
Averaged Train Loss: 0.4293
Averaged Test Accurancy: 0.8997
Averaged Test AUC: 0.9684
Std Test Accurancy: 0.0514
Std Test AUC: 0.0094
-------------------------------------------------- 6.947105646133423

-------------Round number: 23-------------

Evaluate global model
Averaged Train Loss: 0.4207
Averaged Test Accurancy: 0.9054
Averaged Test AUC: 0.9695
Std Test Accurancy: 0.0432
Std Test AUC: 0.0085
-------------------------------------------------- 5.815782070159912

-------------Round number: 24-------------

Evaluate global model
Averaged Train Loss: 0.4001
Averaged Test Accurancy: 0.9082
Averaged Test AUC: 0.9729
Std Test Accurancy: 0.0484
Std Test AUC: 0.0076
-------------------------------------------------- 5.7364583015441895

-------------Round number: 25-------------

Evaluate global model
Averaged Train Loss: 0.3988
Averaged Test Accurancy: 0.9134
Averaged Test AUC: 0.9739
Std Test Accurancy: 0.0578
Std Test AUC: 0.0096
-------------------------------------------------- 6.321263790130615

-------------Round number: 26-------------

Evaluate global model
Averaged Train Loss: 0.3947
Averaged Test Accurancy: 0.9105
Averaged Test AUC: 0.9737
Std Test Accurancy: 0.0557
Std Test AUC: 0.0088
-------------------------------------------------- 7.096829891204834

-------------Round number: 27-------------

Evaluate global model
Averaged Train Loss: 0.3819
Averaged Test Accurancy: 0.9241
Averaged Test AUC: 0.9751
Std Test Accurancy: 0.0392
Std Test AUC: 0.0080
-------------------------------------------------- 7.002898693084717

-------------Round number: 28-------------

Evaluate global model
Averaged Train Loss: 0.3705
Averaged Test Accurancy: 0.9182
Averaged Test AUC: 0.9771
Std Test Accurancy: 0.0496
Std Test AUC: 0.0072
-------------------------------------------------- 7.113917827606201

-------------Round number: 29-------------

Evaluate global model
Averaged Train Loss: 0.3545
Averaged Test Accurancy: 0.9295
Averaged Test AUC: 0.9773
Std Test Accurancy: 0.0397
Std Test AUC: 0.0077
-------------------------------------------------- 6.412213563919067

-------------Round number: 30-------------

Evaluate global model
Averaged Train Loss: 0.3500
Averaged Test Accurancy: 0.9277
Averaged Test AUC: 0.9790
Std Test Accurancy: 0.0462
Std Test AUC: 0.0079
-------------------------------------------------- 7.10218071937561

-------------Round number: 31-------------

Evaluate global model
Averaged Train Loss: 0.3311
Averaged Test Accurancy: 0.9373
Averaged Test AUC: 0.9798
Std Test Accurancy: 0.0323
Std Test AUC: 0.0058
-------------------------------------------------- 7.708104610443115

-------------Round number: 32-------------

Evaluate global model
Averaged Train Loss: 0.3145
Averaged Test Accurancy: 0.9408
Averaged Test AUC: 0.9809
Std Test Accurancy: 0.0322
Std Test AUC: 0.0065
-------------------------------------------------- 7.131870985031128

-------------Round number: 33-------------

Evaluate global model
Averaged Train Loss: 0.3049
Averaged Test Accurancy: 0.9420
Averaged Test AUC: 0.9818
Std Test Accurancy: 0.0340
Std Test AUC: 0.0062
-------------------------------------------------- 7.036477088928223

-------------Round number: 34-------------

Evaluate global model
Averaged Train Loss: 0.2954
Averaged Test Accurancy: 0.9479
Averaged Test AUC: 0.9829
Std Test Accurancy: 0.0333
Std Test AUC: 0.0064
-------------------------------------------------- 7.673170328140259

-------------Round number: 35-------------

Evaluate global model
Averaged Train Loss: 0.2929
Averaged Test Accurancy: 0.9458
Averaged Test AUC: 0.9829
Std Test Accurancy: 0.0314
Std Test AUC: 0.0060
-------------------------------------------------- 7.103743076324463

-------------Round number: 36-------------

Evaluate global model
Averaged Train Loss: 0.2788
Averaged Test Accurancy: 0.9476
Averaged Test AUC: 0.9842
Std Test Accurancy: 0.0363
Std Test AUC: 0.0071
-------------------------------------------------- 7.05030632019043

-------------Round number: 37-------------

Evaluate global model
Averaged Train Loss: 0.2673
Averaged Test Accurancy: 0.9484
Averaged Test AUC: 0.9837
Std Test Accurancy: 0.0330
Std Test AUC: 0.0062
-------------------------------------------------- 7.792221784591675

-------------Round number: 38-------------

Evaluate global model
Averaged Train Loss: 0.2670
Averaged Test Accurancy: 0.9452
Averaged Test AUC: 0.9829
Std Test Accurancy: 0.0338
Std Test AUC: 0.0064
-------------------------------------------------- 6.97216272354126

-------------Round number: 39-------------

Evaluate global model
Averaged Train Loss: 0.2504
Averaged Test Accurancy: 0.9498
Averaged Test AUC: 0.9845
Std Test Accurancy: 0.0377
Std Test AUC: 0.0078
-------------------------------------------------- 7.008472442626953

-------------Round number: 40-------------

Evaluate global model
Averaged Train Loss: 0.2477
Averaged Test Accurancy: 0.9478
Averaged Test AUC: 0.9825
Std Test Accurancy: 0.0251
Std Test AUC: 0.0056
-------------------------------------------------- 7.072888135910034

-------------Round number: 41-------------

Evaluate global model
Averaged Train Loss: 0.2383
Averaged Test Accurancy: 0.9447
Averaged Test AUC: 0.9840
Std Test Accurancy: 0.0433
Std Test AUC: 0.0093
-------------------------------------------------- 7.200278997421265

-------------Round number: 42-------------

Evaluate global model
Averaged Train Loss: 0.2786
Averaged Test Accurancy: 0.9281
Averaged Test AUC: 0.9780
Std Test Accurancy: 0.0459
Std Test AUC: 0.0116
-------------------------------------------------- 7.158849000930786

-------------Round number: 43-------------

Evaluate global model
Averaged Train Loss: 0.3345
Averaged Test Accurancy: 0.9111
Averaged Test AUC: 0.9787
Std Test Accurancy: 0.0865
Std Test AUC: 0.0166
-------------------------------------------------- 7.694677829742432

-------------Round number: 44-------------

Evaluate global model
Averaged Train Loss: 0.6569
Averaged Test Accurancy: 0.8214
Averaged Test AUC: 0.9604
Std Test Accurancy: 0.1545
Std Test AUC: 0.0313
-------------------------------------------------- 7.014740943908691

-------------Round number: 45-------------

Evaluate global model
Averaged Train Loss: 2.6456
Averaged Test Accurancy: 0.6331
Averaged Test AUC: 0.8980
Std Test Accurancy: 0.3941
Std Test AUC: 0.1168
-------------------------------------------------- 7.058734178543091

-------------Round number: 46-------------

Evaluate global model
Averaged Train Loss: 3.3962
Averaged Test Accurancy: 0.5772
Averaged Test AUC: 0.8709
Std Test Accurancy: 0.3328
Std Test AUC: 0.1562
-------------------------------------------------- 7.143362283706665

-------------Round number: 47-------------

Evaluate global model
Averaged Train Loss: 5.2934
Averaged Test Accurancy: 0.6006
Averaged Test AUC: 0.8485
Std Test Accurancy: 0.3503
Std Test AUC: 0.2083
-------------------------------------------------- 7.092125654220581

-------------Round number: 48-------------

Evaluate global model
Averaged Train Loss: 2.2493
Averaged Test Accurancy: 0.7389
Averaged Test AUC: 0.9212
Std Test Accurancy: 0.3695
Std Test AUC: 0.1250
-------------------------------------------------- 7.037450790405273

-------------Round number: 49-------------

Evaluate global model
Averaged Train Loss: 1.0392
Averaged Test Accurancy: 0.8083
Averaged Test AUC: 0.9615
Std Test Accurancy: 0.2646
Std Test AUC: 0.0501
-------------------------------------------------- 7.122360706329346

-------------Round number: 50-------------

Evaluate global model
Averaged Train Loss: 0.5392
Averaged Test Accurancy: 0.8901
Averaged Test AUC: 0.9765
Std Test Accurancy: 0.1157
Std Test AUC: 0.0172
-------------------------------------------------- 7.156907558441162

Best accuracy.
0.9498175182481752

Best local accuracy.

Averaged time per iteration.
7.108310804367066
File path: ../results/MNIST_FedDyn_test_0.h5

Average time cost: 363.71s.
Length:  51
std for best accurancy: 0.0
mean for best accurancy: 0.9498175182481752
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 292759078 	Used Memory: 895.14M
The allocated memory on cuda:0: 947.21M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------

Total time cost: 363.8s.
