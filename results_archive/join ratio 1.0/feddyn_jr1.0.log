==================================================
goal = test
device = cuda
device_id = 0
dataset = MNIST
num_classes = 10
model = CNN
batch_size = 64
local_learning_rate = 0.01
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 50
top_cnt = 100
local_epochs = 5
algorithm = FedDyn
join_ratio = 1.0
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 32000
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 0.1
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
prune_interval = 5
prune_amount = 0.5
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3125
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.4299
Std Test Accurancy: 0.0526
Std Test AUC: 0.1484
-------------------------------------------------- 9.109954357147217

-------------Round number: 1-------------

Evaluate global model
Averaged Train Loss: 2.0920
Averaged Test Accurancy: 0.3231
Averaged Test AUC: 0.8090
Std Test Accurancy: 0.2256
Std Test AUC: 0.0883
-------------------------------------------------- 8.962374687194824

-------------Round number: 2-------------

Evaluate global model
Averaged Train Loss: 1.3765
Averaged Test Accurancy: 0.6471
Averaged Test AUC: 0.9119
Std Test Accurancy: 0.1586
Std Test AUC: 0.0487
-------------------------------------------------- 8.974286556243896

-------------Round number: 3-------------

Evaluate global model
Averaged Train Loss: 1.0825
Averaged Test Accurancy: 0.7150
Averaged Test AUC: 0.9408
Std Test Accurancy: 0.0993
Std Test AUC: 0.0219
-------------------------------------------------- 8.97190237045288

-------------Round number: 4-------------

Evaluate global model
Averaged Train Loss: 1.0502
Averaged Test Accurancy: 0.7506
Averaged Test AUC: 0.9465
Std Test Accurancy: 0.0937
Std Test AUC: 0.0222
-------------------------------------------------- 8.892685413360596

-------------Round number: 5-------------

Evaluate global model
Averaged Train Loss: 0.9570
Averaged Test Accurancy: 0.7715
Averaged Test AUC: 0.9507
Std Test Accurancy: 0.1182
Std Test AUC: 0.0273
-------------------------------------------------- 8.963236808776855

-------------Round number: 6-------------

Evaluate global model
Averaged Train Loss: 0.8359
Averaged Test Accurancy: 0.8018
Averaged Test AUC: 0.9570
Std Test Accurancy: 0.0751
Std Test AUC: 0.0156
-------------------------------------------------- 8.767539262771606

-------------Round number: 7-------------

Evaluate global model
Averaged Train Loss: 0.7634
Averaged Test Accurancy: 0.7961
Averaged Test AUC: 0.9593
Std Test Accurancy: 0.1635
Std Test AUC: 0.0250
-------------------------------------------------- 8.694321632385254

-------------Round number: 8-------------

Evaluate global model
Averaged Train Loss: 0.7026
Averaged Test Accurancy: 0.8066
Averaged Test AUC: 0.9610
Std Test Accurancy: 0.1086
Std Test AUC: 0.0152
-------------------------------------------------- 8.598168849945068

-------------Round number: 9-------------

Evaluate global model
Averaged Train Loss: 0.7065
Averaged Test Accurancy: 0.7964
Averaged Test AUC: 0.9593
Std Test Accurancy: 0.2420
Std Test AUC: 0.0394
-------------------------------------------------- 8.676670551300049

-------------Round number: 10-------------

Evaluate global model
Averaged Train Loss: 0.7587
Averaged Test Accurancy: 0.7622
Averaged Test AUC: 0.9585
Std Test Accurancy: 0.1867
Std Test AUC: 0.0244
-------------------------------------------------- 8.692241430282593

-------------Round number: 11-------------

Evaluate global model
Averaged Train Loss: 1.0551
Averaged Test Accurancy: 0.7773
Averaged Test AUC: 0.9275
Std Test Accurancy: 0.3230
Std Test AUC: 0.1196
-------------------------------------------------- 8.606634140014648

-------------Round number: 12-------------

Evaluate global model
Averaged Train Loss: 0.7188
Averaged Test Accurancy: 0.7724
Averaged Test AUC: 0.9606
Std Test Accurancy: 0.1859
Std Test AUC: 0.0279
-------------------------------------------------- 8.668929815292358

-------------Round number: 13-------------

Evaluate global model
Averaged Train Loss: 0.6085
Averaged Test Accurancy: 0.8220
Averaged Test AUC: 0.9604
Std Test Accurancy: 0.2593
Std Test AUC: 0.0531
-------------------------------------------------- 8.701599836349487

-------------Round number: 14-------------

Evaluate global model
Averaged Train Loss: 0.4924
Averaged Test Accurancy: 0.8625
Averaged Test AUC: 0.9773
Std Test Accurancy: 0.1278
Std Test AUC: 0.0151
-------------------------------------------------- 8.6521155834198

-------------Round number: 15-------------

Evaluate global model
Averaged Train Loss: 0.3369
Averaged Test Accurancy: 0.9160
Averaged Test AUC: 0.9839
Std Test Accurancy: 0.0663
Std Test AUC: 0.0099
-------------------------------------------------- 8.56130051612854

-------------Round number: 16-------------

Evaluate global model
Averaged Train Loss: 0.2977
Averaged Test Accurancy: 0.9327
Averaged Test AUC: 0.9868
Std Test Accurancy: 0.0270
Std Test AUC: 0.0027
-------------------------------------------------- 8.63977861404419

-------------Round number: 17-------------

Evaluate global model
Averaged Train Loss: 0.2791
Averaged Test Accurancy: 0.9359
Averaged Test AUC: 0.9881
Std Test Accurancy: 0.0282
Std Test AUC: 0.0042
-------------------------------------------------- 8.636974334716797

-------------Round number: 18-------------

Evaluate global model
Averaged Train Loss: 0.2617
Averaged Test Accurancy: 0.9405
Averaged Test AUC: 0.9883
Std Test Accurancy: 0.0241
Std Test AUC: 0.0029
-------------------------------------------------- 8.71386432647705

-------------Round number: 19-------------

Evaluate global model
Averaged Train Loss: 0.2466
Averaged Test Accurancy: 0.9449
Averaged Test AUC: 0.9893
Std Test Accurancy: 0.0280
Std Test AUC: 0.0050
-------------------------------------------------- 8.914679527282715

-------------Round number: 20-------------

Evaluate global model
Averaged Train Loss: 0.2331
Averaged Test Accurancy: 0.9490
Averaged Test AUC: 0.9900
Std Test Accurancy: 0.0226
Std Test AUC: 0.0041
-------------------------------------------------- 8.714947700500488

-------------Round number: 21-------------

Evaluate global model
Averaged Train Loss: 0.2278
Averaged Test Accurancy: 0.9464
Averaged Test AUC: 0.9897
Std Test Accurancy: 0.0242
Std Test AUC: 0.0035
-------------------------------------------------- 8.74537181854248

-------------Round number: 22-------------

Evaluate global model
Averaged Train Loss: 0.2215
Averaged Test Accurancy: 0.9494
Averaged Test AUC: 0.9894
Std Test Accurancy: 0.0201
Std Test AUC: 0.0032
-------------------------------------------------- 8.639867544174194

-------------Round number: 23-------------

Evaluate global model
Averaged Train Loss: 0.2236
Averaged Test Accurancy: 0.9469
Averaged Test AUC: 0.9897
Std Test Accurancy: 0.0492
Std Test AUC: 0.0085
-------------------------------------------------- 8.68920111656189

-------------Round number: 24-------------

Evaluate global model
Averaged Train Loss: 0.2066
Averaged Test Accurancy: 0.9501
Averaged Test AUC: 0.9909
Std Test Accurancy: 0.0203
Std Test AUC: 0.0040
-------------------------------------------------- 8.612555265426636

-------------Round number: 25-------------

Evaluate global model
Averaged Train Loss: 0.1941
Averaged Test Accurancy: 0.9561
Averaged Test AUC: 0.9915
Std Test Accurancy: 0.0142
Std Test AUC: 0.0034
-------------------------------------------------- 8.691092729568481

-------------Round number: 26-------------

Evaluate global model
Averaged Train Loss: 0.1863
Averaged Test Accurancy: 0.9578
Averaged Test AUC: 0.9918
Std Test Accurancy: 0.0168
Std Test AUC: 0.0038
-------------------------------------------------- 8.69886040687561

-------------Round number: 27-------------

Evaluate global model
Averaged Train Loss: 0.1777
Averaged Test Accurancy: 0.9596
Averaged Test AUC: 0.9920
Std Test Accurancy: 0.0149
Std Test AUC: 0.0041
-------------------------------------------------- 8.704721689224243

-------------Round number: 28-------------

Evaluate global model
Averaged Train Loss: 0.1794
Averaged Test Accurancy: 0.9556
Averaged Test AUC: 0.9917
Std Test Accurancy: 0.0289
Std Test AUC: 0.0049
-------------------------------------------------- 8.762092351913452

-------------Round number: 29-------------

Evaluate global model
Averaged Train Loss: 0.1726
Averaged Test Accurancy: 0.9605
Averaged Test AUC: 0.9915
Std Test Accurancy: 0.0144
Std Test AUC: 0.0041
-------------------------------------------------- 8.48293399810791

-------------Round number: 30-------------

Evaluate global model
Averaged Train Loss: 0.2168
Averaged Test Accurancy: 0.9452
Averaged Test AUC: 0.9877
Std Test Accurancy: 0.0598
Std Test AUC: 0.0133
-------------------------------------------------- 8.606587648391724

-------------Round number: 31-------------

Evaluate global model
Averaged Train Loss: 0.1937
Averaged Test Accurancy: 0.9529
Averaged Test AUC: 0.9903
Std Test Accurancy: 0.0298
Std Test AUC: 0.0079
-------------------------------------------------- 8.694482326507568

-------------Round number: 32-------------

Evaluate global model
Averaged Train Loss: 0.1913
Averaged Test Accurancy: 0.9505
Averaged Test AUC: 0.9906
Std Test Accurancy: 0.0306
Std Test AUC: 0.0063
-------------------------------------------------- 8.664927005767822

-------------Round number: 33-------------

Evaluate global model
Averaged Train Loss: 0.1636
Averaged Test Accurancy: 0.9591
Averaged Test AUC: 0.9916
Std Test Accurancy: 0.0229
Std Test AUC: 0.0058
-------------------------------------------------- 8.603116750717163

-------------Round number: 34-------------

Evaluate global model
Averaged Train Loss: 0.2009
Averaged Test Accurancy: 0.9484
Averaged Test AUC: 0.9884
Std Test Accurancy: 0.0617
Std Test AUC: 0.0145
-------------------------------------------------- 8.734939575195312

-------------Round number: 35-------------

Evaluate global model
Averaged Train Loss: 0.1730
Averaged Test Accurancy: 0.9507
Averaged Test AUC: 0.9911
Std Test Accurancy: 0.0382
Std Test AUC: 0.0077
-------------------------------------------------- 8.689790725708008

-------------Round number: 36-------------

Evaluate global model
Averaged Train Loss: 0.1642
Averaged Test Accurancy: 0.9598
Averaged Test AUC: 0.9919
Std Test Accurancy: 0.0391
Std Test AUC: 0.0073
-------------------------------------------------- 8.64877724647522

-------------Round number: 37-------------

Evaluate global model
Averaged Train Loss: 0.1466
Averaged Test Accurancy: 0.9606
Averaged Test AUC: 0.9925
Std Test Accurancy: 0.0238
Std Test AUC: 0.0043
-------------------------------------------------- 8.752891778945923

-------------Round number: 38-------------

Evaluate global model
Averaged Train Loss: 0.1418
Averaged Test Accurancy: 0.9651
Averaged Test AUC: 0.9931
Std Test Accurancy: 0.0246
Std Test AUC: 0.0044
-------------------------------------------------- 8.683764457702637

-------------Round number: 39-------------

Evaluate global model
Averaged Train Loss: 0.1490
Averaged Test Accurancy: 0.9630
Averaged Test AUC: 0.9923
Std Test Accurancy: 0.0296
Std Test AUC: 0.0055
-------------------------------------------------- 8.749713659286499

-------------Round number: 40-------------

Evaluate global model
Averaged Train Loss: 0.1606
Averaged Test Accurancy: 0.9545
Averaged Test AUC: 0.9918
Std Test Accurancy: 0.0266
Std Test AUC: 0.0056
-------------------------------------------------- 8.740677833557129

-------------Round number: 41-------------

Evaluate global model
Averaged Train Loss: 0.1508
Averaged Test Accurancy: 0.9630
Averaged Test AUC: 0.9912
Std Test Accurancy: 0.0261
Std Test AUC: 0.0066
-------------------------------------------------- 8.79345440864563

-------------Round number: 42-------------

Evaluate global model
Averaged Train Loss: 0.1390
Averaged Test Accurancy: 0.9649
Averaged Test AUC: 0.9924
Std Test Accurancy: 0.0153
Std Test AUC: 0.0035
-------------------------------------------------- 8.660687685012817

-------------Round number: 43-------------

Evaluate global model
Averaged Train Loss: 0.1641
Averaged Test Accurancy: 0.9553
Averaged Test AUC: 0.9910
Std Test Accurancy: 0.0471
Std Test AUC: 0.0086
-------------------------------------------------- 8.699352979660034

-------------Round number: 44-------------

Evaluate global model
Averaged Train Loss: 0.1372
Averaged Test Accurancy: 0.9633
Averaged Test AUC: 0.9923
Std Test Accurancy: 0.0230
Std Test AUC: 0.0048
-------------------------------------------------- 8.683655977249146

-------------Round number: 45-------------

Evaluate global model
Averaged Train Loss: 0.1262
Averaged Test Accurancy: 0.9684
Averaged Test AUC: 0.9935
Std Test Accurancy: 0.0168
Std Test AUC: 0.0034
-------------------------------------------------- 8.608438491821289

-------------Round number: 46-------------

Evaluate global model
Averaged Train Loss: 0.1243
Averaged Test Accurancy: 0.9676
Averaged Test AUC: 0.9933
Std Test Accurancy: 0.0126
Std Test AUC: 0.0033
-------------------------------------------------- 8.610863447189331

-------------Round number: 47-------------

Evaluate global model
Averaged Train Loss: 0.1332
Averaged Test Accurancy: 0.9627
Averaged Test AUC: 0.9922
Std Test Accurancy: 0.0252
Std Test AUC: 0.0056
-------------------------------------------------- 8.63132119178772

-------------Round number: 48-------------

Evaluate global model
Averaged Train Loss: 0.1308
Averaged Test Accurancy: 0.9648
Averaged Test AUC: 0.9917
Std Test Accurancy: 0.0251
Std Test AUC: 0.0059
-------------------------------------------------- 8.702350616455078

-------------Round number: 49-------------

Evaluate global model
Averaged Train Loss: 0.1122
Averaged Test Accurancy: 0.9699
Averaged Test AUC: 0.9925
Std Test Accurancy: 0.0167
Std Test AUC: 0.0043
-------------------------------------------------- 8.612207412719727

-------------Round number: 50-------------

Evaluate global model
Averaged Train Loss: 0.1176
Averaged Test Accurancy: 0.9664
Averaged Test AUC: 0.9923
Std Test Accurancy: 0.0165
Std Test AUC: 0.0039
-------------------------------------------------- 8.690547227859497

Best accuracy.
0.9698977551836409

Best local accuracy.

Averaged time per iteration.
8.705869946479798
File path: ../results/MNIST_FedDyn_test_0.h5

Average time cost: 445.17s.
Length:  51
std for best accurancy: 0.0
mean for best accurancy: 0.9698977551836409
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 59948678 	Used Memory: 184.36M
The allocated memory on cuda:0: 213.03M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------

Total time cost: 445.24s.
