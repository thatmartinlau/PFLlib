==================================================
goal = test
device = cuda
device_id = 0
dataset = MNIST
num_classes = 10
model = CNN
batch_size = 64
local_learning_rate = 0.001
learning_rate_decay = False
learning_rate_decay_gamma = 0.99
global_rounds = 50
top_cnt = 100
local_epochs = 5
algorithm = MOON
join_ratio = 0.8
random_join_ratio = False
num_clients = 20
prev = 0
times = 1
eval_gap = 1
save_folder_name = items
auto_break = False
dlg_eval = False
dlg_gap = 100
batch_num_per_client = 2
num_new_clients = 0
fine_tuning_epoch_new = 0
feature_dim = 512
vocab_size = 32000
max_len = 200
client_drop_rate = 0.0
train_slow_rate = 0.0
send_slow_rate = 0.0
time_select = False
time_threthold = 10000
beta = 0.0
lamda = 1.0
mu = 0.0
K = 5
p_learning_rate = 0.01
M = 5
itk = 4000
alphaK = 1.0
sigma = 1.0
alpha = 1.0
plocal_epochs = 1
tau = 1.0
fine_tuning_epochs = 10
dr_learning_rate = 0.0
L = 1.0
noise_dim = 512
generator_learning_rate = 0.005
hidden_dim = 512
server_epochs = 1000
localize_feature_extractor = False
server_learning_rate = 1.0
eta = 1.0
rand_percent = 80
layer_idx = 2
mentee_learning_rate = 0.005
T_start = 0.95
T_end = 0.98
momentum = 0.1
kl_weight = 0.0
prune_interval = 5
prune_amount = 0.5
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 0.8 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global model
Averaged Train Loss: 2.3125
Averaged Test Accurancy: 0.0583
Averaged Test AUC: 0.4299
Std Test Accurancy: 0.0526
Std Test AUC: 0.1484
-------------------------------------------------- 10.70276689529419

-------------Round number: 1-------------

Evaluate global model
Averaged Train Loss: 2.3072
Averaged Test Accurancy: 0.1492
Averaged Test AUC: 0.5539
Std Test Accurancy: 0.1973
Std Test AUC: 0.3321
-------------------------------------------------- 11.954969882965088

-------------Round number: 2-------------

Evaluate global model
Averaged Train Loss: 2.2107
Averaged Test Accurancy: 0.3748
Averaged Test AUC: 0.6573
Std Test Accurancy: 0.3441
Std Test AUC: 0.3556
-------------------------------------------------- 11.223853826522827

-------------Round number: 3-------------

Evaluate global model
Averaged Train Loss: 2.1195
Averaged Test Accurancy: 0.4752
Averaged Test AUC: 0.7089
Std Test Accurancy: 0.3901
Std Test AUC: 0.3500
-------------------------------------------------- 12.129759788513184

-------------Round number: 4-------------

Evaluate global model
Averaged Train Loss: 1.9608
Averaged Test Accurancy: 0.4721
Averaged Test AUC: 0.7508
Std Test Accurancy: 0.3922
Std Test AUC: 0.2688
-------------------------------------------------- 12.383135318756104

-------------Round number: 5-------------

Evaluate global model
Averaged Train Loss: 1.8103
Averaged Test Accurancy: 0.5430
Averaged Test AUC: 0.8804
Std Test Accurancy: 0.3580
Std Test AUC: 0.1104
-------------------------------------------------- 12.179867506027222

-------------Round number: 6-------------

Evaluate global model
Averaged Train Loss: 1.6913
Averaged Test Accurancy: 0.6070
Averaged Test AUC: 0.9181
Std Test Accurancy: 0.2456
Std Test AUC: 0.0448
-------------------------------------------------- 11.78780198097229

-------------Round number: 7-------------

Evaluate global model
Averaged Train Loss: 1.5875
Averaged Test Accurancy: 0.6093
Averaged Test AUC: 0.9056
Std Test Accurancy: 0.2911
Std Test AUC: 0.0873
-------------------------------------------------- 11.84956693649292

-------------Round number: 8-------------

Evaluate global model
Averaged Train Loss: 1.5048
Averaged Test Accurancy: 0.6209
Averaged Test AUC: 0.8761
Std Test Accurancy: 0.3114
Std Test AUC: 0.1654
-------------------------------------------------- 10.946339130401611

-------------Round number: 9-------------

Evaluate global model
Averaged Train Loss: 1.4768
Averaged Test Accurancy: 0.5229
Averaged Test AUC: 0.8603
Std Test Accurancy: 0.3744
Std Test AUC: 0.1401
-------------------------------------------------- 9.395648717880249

-------------Round number: 10-------------

Evaluate global model
Averaged Train Loss: 1.5848
Averaged Test Accurancy: 0.3969
Averaged Test AUC: 0.8289
Std Test Accurancy: 0.4154
Std Test AUC: 0.1577
-------------------------------------------------- 11.611972570419312

-------------Round number: 11-------------

Evaluate global model
Averaged Train Loss: 1.3732
Averaged Test Accurancy: 0.6252
Averaged Test AUC: 0.8637
Std Test Accurancy: 0.3235
Std Test AUC: 0.1870
-------------------------------------------------- 10.884933471679688

-------------Round number: 12-------------

Evaluate global model
Averaged Train Loss: 1.3312
Averaged Test Accurancy: 0.5942
Averaged Test AUC: 0.8838
Std Test Accurancy: 0.3012
Std Test AUC: 0.1313
-------------------------------------------------- 10.968097686767578

-------------Round number: 13-------------

Evaluate global model
Averaged Train Loss: 1.2609
Averaged Test Accurancy: 0.5834
Averaged Test AUC: 0.8980
Std Test Accurancy: 0.3197
Std Test AUC: 0.0930
-------------------------------------------------- 11.02794337272644

-------------Round number: 14-------------

Evaluate global model
Averaged Train Loss: 1.2071
Averaged Test Accurancy: 0.6047
Averaged Test AUC: 0.8946
Std Test Accurancy: 0.3434
Std Test AUC: 0.1037
-------------------------------------------------- 12.125771760940552

-------------Round number: 15-------------

Evaluate global model
Averaged Train Loss: 1.1123
Averaged Test Accurancy: 0.6603
Averaged Test AUC: 0.9195
Std Test Accurancy: 0.2511
Std Test AUC: 0.0643
-------------------------------------------------- 12.069776058197021

-------------Round number: 16-------------

Evaluate global model
Averaged Train Loss: 1.0676
Averaged Test Accurancy: 0.6802
Averaged Test AUC: 0.9296
Std Test Accurancy: 0.2076
Std Test AUC: 0.0426
-------------------------------------------------- 12.319933414459229

-------------Round number: 17-------------

Evaluate global model
Averaged Train Loss: 1.0294
Averaged Test Accurancy: 0.6994
Averaged Test AUC: 0.9324
Std Test Accurancy: 0.1738
Std Test AUC: 0.0377
-------------------------------------------------- 11.383371114730835

-------------Round number: 18-------------

Evaluate global model
Averaged Train Loss: 1.0320
Averaged Test Accurancy: 0.7095
Averaged Test AUC: 0.9364
Std Test Accurancy: 0.0717
Std Test AUC: 0.0135
-------------------------------------------------- 11.178426504135132

-------------Round number: 19-------------

Evaluate global model
Averaged Train Loss: 1.0720
Averaged Test Accurancy: 0.6566
Averaged Test AUC: 0.9086
Std Test Accurancy: 0.3097
Std Test AUC: 0.0994
-------------------------------------------------- 9.90419316291809

-------------Round number: 20-------------

Evaluate global model
Averaged Train Loss: 1.1960
Averaged Test Accurancy: 0.6011
Averaged Test AUC: 0.8831
Std Test Accurancy: 0.3635
Std Test AUC: 0.1315
-------------------------------------------------- 12.41104006767273

-------------Round number: 21-------------

Evaluate global model
Averaged Train Loss: 0.9596
Averaged Test Accurancy: 0.7071
Averaged Test AUC: 0.9315
Std Test Accurancy: 0.2049
Std Test AUC: 0.0490
-------------------------------------------------- 10.57391881942749

-------------Round number: 22-------------

Evaluate global model
Averaged Train Loss: 1.0383
Averaged Test Accurancy: 0.6500
Averaged Test AUC: 0.9197
Std Test Accurancy: 0.2617
Std Test AUC: 0.0658
-------------------------------------------------- 9.979196310043335

-------------Round number: 23-------------

Evaluate global model
Averaged Train Loss: 1.0310
Averaged Test Accurancy: 0.6379
Averaged Test AUC: 0.9305
Std Test Accurancy: 0.1995
Std Test AUC: 0.0291
-------------------------------------------------- 12.03847885131836

-------------Round number: 24-------------

Evaluate global model
Averaged Train Loss: 0.9117
Averaged Test Accurancy: 0.7235
Averaged Test AUC: 0.9391
Std Test Accurancy: 0.1365
Std Test AUC: 0.0291
-------------------------------------------------- 10.653373003005981

-------------Round number: 25-------------

Evaluate global model
Averaged Train Loss: 0.9624
Averaged Test Accurancy: 0.6890
Averaged Test AUC: 0.9309
Std Test Accurancy: 0.1897
Std Test AUC: 0.0389
-------------------------------------------------- 11.12680721282959

-------------Round number: 26-------------

Evaluate global model
Averaged Train Loss: 0.9905
Averaged Test Accurancy: 0.6500
Averaged Test AUC: 0.9286
Std Test Accurancy: 0.2318
Std Test AUC: 0.0469
-------------------------------------------------- 11.190888404846191

-------------Round number: 27-------------

Evaluate global model
Averaged Train Loss: 0.9177
Averaged Test Accurancy: 0.7118
Averaged Test AUC: 0.9387
Std Test Accurancy: 0.0444
Std Test AUC: 0.0070
-------------------------------------------------- 10.107720136642456

-------------Round number: 28-------------

Evaluate global model
Averaged Train Loss: 0.9828
Averaged Test Accurancy: 0.6663
Averaged Test AUC: 0.9236
Std Test Accurancy: 0.2574
Std Test AUC: 0.0669
-------------------------------------------------- 10.727803707122803

-------------Round number: 29-------------

Evaluate global model
Averaged Train Loss: 0.9534
Averaged Test Accurancy: 0.6800
Averaged Test AUC: 0.9216
Std Test Accurancy: 0.2870
Std Test AUC: 0.0822
-------------------------------------------------- 11.689456701278687

-------------Round number: 30-------------

Evaluate global model
Averaged Train Loss: 0.8660
Averaged Test Accurancy: 0.7181
Averaged Test AUC: 0.9365
Std Test Accurancy: 0.1835
Std Test AUC: 0.0417
-------------------------------------------------- 11.80125093460083

-------------Round number: 31-------------

Evaluate global model
Averaged Train Loss: 0.8512
Averaged Test Accurancy: 0.7322
Averaged Test AUC: 0.9381
Std Test Accurancy: 0.1649
Std Test AUC: 0.0391
-------------------------------------------------- 10.383995056152344

-------------Round number: 32-------------

Evaluate global model
Averaged Train Loss: 0.9437
Averaged Test Accurancy: 0.6929
Averaged Test AUC: 0.9289
Std Test Accurancy: 0.2092
Std Test AUC: 0.0635
-------------------------------------------------- 10.386109352111816

-------------Round number: 33-------------

Evaluate global model
Averaged Train Loss: 0.9440
Averaged Test Accurancy: 0.6535
Averaged Test AUC: 0.9303
Std Test Accurancy: 0.2722
Std Test AUC: 0.0522
-------------------------------------------------- 12.191574096679688

-------------Round number: 34-------------

Evaluate global model
Averaged Train Loss: 0.8228
Averaged Test Accurancy: 0.7375
Averaged Test AUC: 0.9401
Std Test Accurancy: 0.1525
Std Test AUC: 0.0357
-------------------------------------------------- 11.281734943389893

-------------Round number: 35-------------

Evaluate global model
Averaged Train Loss: 0.8384
Averaged Test Accurancy: 0.7245
Averaged Test AUC: 0.9377
Std Test Accurancy: 0.1869
Std Test AUC: 0.0418
-------------------------------------------------- 11.975825786590576

-------------Round number: 36-------------

Evaluate global model
Averaged Train Loss: 0.8138
Averaged Test Accurancy: 0.7391
Averaged Test AUC: 0.9406
Std Test Accurancy: 0.1575
Std Test AUC: 0.0359
-------------------------------------------------- 11.131775379180908

-------------Round number: 37-------------

Evaluate global model
Averaged Train Loss: 0.8224
Averaged Test Accurancy: 0.7391
Averaged Test AUC: 0.9432
Std Test Accurancy: 0.0566
Std Test AUC: 0.0122
-------------------------------------------------- 11.888666868209839

-------------Round number: 38-------------

Evaluate global model
Averaged Train Loss: 0.7895
Averaged Test Accurancy: 0.7496
Averaged Test AUC: 0.9430
Std Test Accurancy: 0.1342
Std Test AUC: 0.0318
-------------------------------------------------- 11.942036151885986

-------------Round number: 39-------------

Evaluate global model
Averaged Train Loss: 0.7999
Averaged Test Accurancy: 0.7453
Averaged Test AUC: 0.9422
Std Test Accurancy: 0.1561
Std Test AUC: 0.0343
-------------------------------------------------- 11.793394565582275

-------------Round number: 40-------------

Evaluate global model
Averaged Train Loss: 0.7814
Averaged Test Accurancy: 0.7516
Averaged Test AUC: 0.9451
Std Test Accurancy: 0.1319
Std Test AUC: 0.0274
-------------------------------------------------- 10.847541093826294

-------------Round number: 41-------------

Evaluate global model
Averaged Train Loss: 0.8108
Averaged Test Accurancy: 0.7301
Averaged Test AUC: 0.9434
Std Test Accurancy: 0.1104
Std Test AUC: 0.0246
-------------------------------------------------- 11.002076387405396

-------------Round number: 42-------------

Evaluate global model
Averaged Train Loss: 0.8681
Averaged Test Accurancy: 0.6998
Averaged Test AUC: 0.9365
Std Test Accurancy: 0.1786
Std Test AUC: 0.0390
-------------------------------------------------- 10.706347227096558

-------------Round number: 43-------------

Evaluate global model
Averaged Train Loss: 0.8358
Averaged Test Accurancy: 0.7305
Averaged Test AUC: 0.9400
Std Test Accurancy: 0.1539
Std Test AUC: 0.0404
-------------------------------------------------- 10.027270793914795

-------------Round number: 44-------------

Evaluate global model
Averaged Train Loss: 0.8314
Averaged Test Accurancy: 0.7161
Averaged Test AUC: 0.9423
Std Test Accurancy: 0.0846
Std Test AUC: 0.0184
-------------------------------------------------- 10.040941715240479

-------------Round number: 45-------------

Evaluate global model
Averaged Train Loss: 0.9014
Averaged Test Accurancy: 0.6766
Averaged Test AUC: 0.9356
Std Test Accurancy: 0.1462
Std Test AUC: 0.0320
-------------------------------------------------- 11.795034408569336

-------------Round number: 46-------------

Evaluate global model
Averaged Train Loss: 0.7662
Averaged Test Accurancy: 0.7496
Averaged Test AUC: 0.9473
Std Test Accurancy: 0.0578
Std Test AUC: 0.0121
-------------------------------------------------- 10.873302221298218

-------------Round number: 47-------------

Evaluate global model
Averaged Train Loss: 0.8495
Averaged Test Accurancy: 0.6931
Averaged Test AUC: 0.9400
Std Test Accurancy: 0.2030
Std Test AUC: 0.0372
-------------------------------------------------- 9.9016695022583

-------------Round number: 48-------------

Evaluate global model
Averaged Train Loss: 0.8898
Averaged Test Accurancy: 0.6869
Averaged Test AUC: 0.9296
Std Test Accurancy: 0.2727
Std Test AUC: 0.0725
-------------------------------------------------- 10.929229497909546

-------------Round number: 49-------------

Evaluate global model
Averaged Train Loss: 0.7783
Averaged Test Accurancy: 0.7376
Averaged Test AUC: 0.9443
Std Test Accurancy: 0.1061
Std Test AUC: 0.0226
-------------------------------------------------- 12.178531885147095

-------------Round number: 50-------------

Evaluate global model
Averaged Train Loss: 0.7216
Averaged Test Accurancy: 0.7700
Averaged Test AUC: 0.9494
Std Test Accurancy: 0.1000
Std Test AUC: 0.0218
-------------------------------------------------- 9.82988715171814

Best accuracy.
0.7699777231964358

Best local accuracy.

Averaged time per iteration.
11.214644808769226
File path: ../results/MNIST_MOON_test_0.h5

Average time cost: 572.18s.
Length:  51
std for best accurancy: 0.0
mean for best accurancy: 0.7699777231964358
All done!

Storage on cuda:0
-------------------------------------------------------------------------------
Total Tensors: 48308158 	Used Memory: 139.97M
The allocated memory on cuda:0: 156.97M
Memory differs due to the matrix alignment or invisible gradient buffer tensors
-------------------------------------------------------------------------------

Total time cost: 572.24s.
